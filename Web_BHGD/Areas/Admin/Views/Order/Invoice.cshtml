@model Web_BHGD.Models.Order

@{
    ViewData["Title"] = $"Hóa đơn đơn hàng #{Model.Id}";
    Layout = null;
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <title>@ViewData["Title"]</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body {
            padding: 2rem;
            font-family: "Segoe UI", sans-serif;
            background-color: #fff;
            color: #000;
        }
        h2, h4 {
            margin-bottom: 1rem;
        }
        .invoice-details {
            margin-bottom: 2rem;
        }
        .invoice-footer {
            margin-top: 2rem;
            font-style: italic;
        }
        .table th, .table td {
            vertical-align: middle;
        }
        @@media print {
            .btn-print {
                display: none;
            }
        }
    </style>
</head>
<body>
    <h2 class="text-center text-uppercase">HÓA ĐƠN BÁN HÀNG</h2>

    <p><strong>Mã đơn hàng:</strong> #@Model.Id</p>
    <p><strong>Ngày đặt:</strong> @Model.OrderDate.ToString("dd/MM/yyyy HH:mm")</p>

    <div class="invoice-details">
        <h4>Thông tin khách hàng</h4>
        <p><strong>Tên:</strong> @(Model.ApplicationUser?.UserName ?? Model.CustomerName)</p>
        <p><strong>Điện thoại:</strong> @Model.CustomerPhone</p>
        <p><strong>Email:</strong> @Model.CustomerEmail</p>
        <p><strong>Địa chỉ:</strong> @Model.ShippingAddress</p>
        <p><strong>Phương thức thanh toán:</strong>
            @(Model.PaymentMethod switch
            {
                "COD" => "Thanh toán khi nhận hàng",
                "Bank" => "Ngân hàng",
                "MoMo" => "MoMo",
                _ => Model.PaymentMethod
            })
        </p>
    </div>

    <div class="invoice-details">
        <h4>Ghi chú</h4>
        <p>@(string.IsNullOrWhiteSpace(Model.Notes) ? "Không có ghi chú" : Model.Notes)</p>
    </div>

    <div class="invoice-details">
        <h4>Chi tiết đơn hàng</h4>
        <div class="table-responsive">
            <table class="table table-bordered table-striped">
                <thead class="table-light">
                    <tr>
                        <th scope="col">Tên sản phẩm</th>
                        <th scope="col">Đơn giá</th>
                        <th scope="col">Số lượng</th>
                        <th scope="col">Thành tiền</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var detail in Model.OrderDetails)
                    {
                        <tr>
                            <td>@detail.Product.Name</td>
                            <td>@detail.Price.ToString("#,##0")₫</td>
                            <td>@detail.Quantity</td>
                            <td>@(detail.Price * detail.Quantity).ToString("#,##0")₫</td>
                        </tr>
                    }
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3" class="text-end fw-bold">Tổng cộng:</td>
                        <td class="fw-bold">@Model.TotalPrice.ToString("#,##0")₫</td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <div class="invoice-footer">
        <p>Cảm ơn quý khách đã mua sắm tại <strong>BHGD Store</strong>!</p>
        <p><em>Hóa đơn này được tạo tự động và không cần chữ ký xác nhận.</em></p>
    </div>

    <div class="text-end mt-4 btn-print">
        <a href="javascript:window.print()" class="btn btn-outline-primary me-2">🖨 In hóa đơn</a>
        <a asp-area="Admin" asp-controller="Order" asp-action="Index" class="btn btn-primary">⬅ Quay lại</a>
    </div>
</body>
</html>
